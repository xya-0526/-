# Set与Map

set和map 是对数组和对象的 弥补 

set 是 一个唯一值集合 自动去重 常用来对数组经行去重

map 是 键值对集合 弥补 对象 键名只能是字面量或 syboml  其键名可以是任何类型

## Set：一种 **无重复值的集合**

### ✅ 特点：

- **值唯一**（自动去重）
- 类似数组，但成员不重复
- 可遍历（支持 `for...of`，有 `forEach`）
- 支持基本集合操作

### 🧪 常用方法：

```
js复制编辑let s = new Set([1, 2, 2, 3]);
console.log(s); // Set(3) {1, 2, 3}

s.add(4);       // 添加
s.delete(2);    // 删除
s.has(3);       // true
s.size;         // 3
s.clear();      // 清空
```

### 🎯 使用场景：

- 数组去重：`[...new Set(arr)]`
- 判断是否存在：性能比数组 `includes` 更快
- 对数据集合进行并集、交集、差集等操作（可通过扩展封装）

## 🔹 Map：一种更强大的 **键值对集合**

### ✅ 特点：

- 键可以是 **任意类型**（不像对象只能是字符串或 Symbol）
- 保持插入顺序
- 可遍历（`forEach`, `for...of`）

### 🧪 常用方法：

```
js复制编辑let m = new Map();
let objKey = { id: 1 };

m.set(objKey, 'value'); // 设置键值
m.get(objKey);          // 'value'
m.has(objKey);          // true
m.delete(objKey);       // 删除
m.size;                 // 数量
m.clear();              // 清空
```

### 🎯 使用场景：

- 需要键为对象的映射结构（如缓存机制）
- 更复杂的关联数据存储（比 Object 更安全和强大）
- 保证键值对顺序时使用（如构建 LRU 缓存）

------

## 🆚 Set / Map 与 Object / Array 区别总结

| 特性           | Set            | Map            | Array    | Object            |
| -------------- | -------------- | -------------- | -------- | ----------------- |
| 是否键值结构   | 否             | 是             | 否       | 是                |
| 键是否可为对象 | —              | ✅              | —        | ❌（自动转字符串） |
| 是否去重       | ✅              | —              | ❌        | —                 |
| 是否可遍历     | ✅              | ✅              | ✅        | 部分需要额外处理  |
| 适合的使用场景 | 去重、集合操作 | 键值映射、缓存 | 列表数据 | 简单结构数据      |



------

## 💬 面试答题建议（简洁版）

你可以这样总结来答面试官的问题：

> ES6 中新增的 Set 和 Map 是对原有 Array 和 Object 的增强。Set 是一个值唯一的集合，常用于数组去重和集合运算。而 Map 是一个键值对集合，键可以是任意类型，适用于更复杂的映射场景，比如对象作为键、缓存数据等。它们都支持迭代操作，比传统数据结构在某些场景下更高效和语义更清晰。

## 🧩 一、WeakSet

### ✅ 特点：

- 类似 `Set`，但是 **只能存储对象**，不能存储原始值。
- 对象是 **弱引用**：如果没有其他引用指向这个对象，对象会被垃圾回收。
- **不能遍历**（没有 `size`、没有 `forEach`、不能 `for...of`）
- 适合用来存储**一组对象的存在性信息**，如标记某对象是否被访问过。

### 🧪 示例：

```
const ws = new WeakSet();

let obj = {name: 'test'};
ws.add(obj);
console.log(ws.has(obj)); // true

obj = null; // 原始对象被置空
// 此时 WeakSet 中的对象也可能被垃圾回收（不保证何时发生）
```

------

## 🧩 二、WeakMap

### ✅ 特点：

- 类似 `Map`，但键 **只能是对象**（不能是字符串、数字等）。
- 键是 **弱引用**，对象被销毁时会自动从 `WeakMap` 中移除。
- **不能遍历、没有 `size` 属性**。
- 非常适合用来为对象添加**私有数据或元数据**，防止内存泄漏。

### 🧪 示例：私有属性存储

```
const privateData = new WeakMap();

function Person(name) {
  const data = { name };
  privateData.set(this, data);
}

Person.prototype.getName = function() {
  return privateData.get(this).name;
};

const p = new Person("Alice");
console.log(p.getName()); // "Alice"
```

------

## 🚫 WeakMap / WeakSet 与 Map / Set 的区别总结

| 特性               | Map            | WeakMap        | Set       | WeakSet      |
| ------------------ | -------------- | -------------- | --------- | ------------ |
| 是否键值对结构     | ✅              | ✅              | ❌         | ❌            |
| 是否弱引用         | ❌              | ✅              | ❌         | ✅            |
| 是否可遍历         | ✅              | ❌              | ✅         | ❌            |
| 键或值是否可为对象 | ✅（任意）      | ✅（对象）      | ✅（任意） | ✅（对象）    |
| 是否有 `size` 属性 | ✅              | ❌              | ✅         | ❌            |
| 主要应用场景       | 显式存储键值对 | 私有属性、缓存 | 去重      | 临时对象标记 |



------

## 💬 面试答题建议（简洁版）

你可以这样回答：

> WeakMap 和 WeakSet 是 Map 和 Set 的弱引用版本，专门设计用来对对象进行弱引用管理。它们的键或值必须是对象，不可遍历，也没有 `size` 属性。这种设计是为了配合垃圾回收机制，避免内存泄漏。WeakMap 常用于私有数据封装，WeakSet 可用于标记对象是否访问过等操作。由于不能遍历，它们更适合做内部状态的维护，而不是通用存储结构。