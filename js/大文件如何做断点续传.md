# 断点续传

核心：前端 对 文件进行 分段切割 并且对每一段都经行唯一标识 通过唯一标识判断上传进度 。服务端记录哪些块已上传，中断后 客户端只上传未完成的部分。

## 实现步骤

#### 1. **前端处理流程**

- **切片（Chunk）处理**：使用 `File.prototype.slice()` 方法将文件分割成多个小块。
- **每块生成唯一标识（hash）**：可基于文件名 + 块索引生成（如 `md5(file.name + index)`），或整体文件生成唯一 hash（如使用 SparkMD5）。
- **上传状态检查**：先向服务端询问哪些块已上传。
- **并发上传剩余块**：可使用 `Promise.all` 限制并发。
- **上传完成后发送合并请求**。

#### 2. **后端处理流程**

- **接收块并保存**：每个块单独保存，带上块索引和文件唯一ID。
- **记录上传状态**：保存哪些块已上传（可存在数据库或缓存中，如 Redis）。
- **接收到所有块后合并**：按顺序拼接成原始文件。
- **支持校验与清理**：合并后校验完整性，并清理临时文件。

### 四、补充优化项（可加分）

- **秒传功能**：若文件 hash 已存在，直接返回上传完成（不必上传）
- **前端校验上传成功状态**：失败重试、进度条展示
- **支持 WebSocket/轮询显示上传进度**

### 五、总结（可背下来说）

> 大文件断点续传通过将文件分块上传，每个块独立标识与上传，后端记录已上传块，实现中断后续传。核心包括前端切片上传、后端状态记录与合并，常用技术有 `slice`、`FormData`、Redis、流式合并等。